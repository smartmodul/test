class RfidContext{constructor(){this.createModal(),this.createButton()}createModal(){$('<div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="rfidLabel"></h5></div><div class="modal-body"><div class="addLoader">Waiting for card ...<br></div><div class="addLoader spinner-grow" style="width: 3rem; height: 3rem;" role="status"></div><div id="rfidAdded"></div><div id="rfidFail"></div><form><div class="mb-2"><textarea class="form-control" id="msg"></textarea></div></form></div><div class="modal-footer"><button id="hideRFID" type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button><button id="saveRFID" type="button" class="btn btn-primary">Save</button></div></div></div>').appendTo("#rfidModal"),document.getElementById("saveRFID").addEventListener("click",function(){let a=$("#rfidLabel").text().substring(11);$("#id"+a).text($("#msg").val()),$("#rfidModal").modal("hide")}),document.getElementById("hideRFID").addEventListener("click",function(){$("#rfidModal").modal("hide")})}createButton(){$('<div id="rfid0" class="container-sm text-center mt-3 w-60"><div class="btn-group w-100" role="group"><button id="refreshRfid" type="button" class="btn btn-primary btn-outline-light"><i class="fas fa-redo fa-2x"></i></button><button id="addRfid" type="button" class="btn btn-primary btn-outline-light"><i class="fas fa-user-plus fa-2x"></i></button><button id="saveRfid" type="button" class="btn btn-primary btn-outline-light"><i class="far fa-save fa-2x"></i></button></div></div>').appendTo("#rfidBtn")}}class CreateRfidList{constructor(a){this.createRFIDList(a)}createRFID(a,b,c){$('<div id="rfid'+a+'" class="container-sm text-center mt-3 w-60"><div class="card bg-grey"><div class="row justify-content-md-center"><div class="col-4 align-self-center text-right"><i class="fas fa-id-card fa-3x"></i></div><div class="col text-left"><div id="id'+a+'" class="font-weight-bold">'+c+'</div><div style="font-size:13px;" class="font-italic">'+b+'</div></div></div><div class="btn-group" role="group"><button id="remove'+a+'" type="button" class="btn btn-dark btn-outline-light"><i class="far fa-trash-alt"></i></button><button id="edit'+a+'" type="button" class="btn btn-dark btn-outline-light"><i class="fas fa-user-edit"></i></button></div></div></div>').insertAfter("#rfid"+(a-1)),document.getElementById("remove"+a).addEventListener("click",function(){$("#rfid"+a).remove()}),document.getElementById("edit"+a).addEventListener("click",function(){$("#rfidLabel").text("Edit user: "+a),$("#msg").val(c),$("#msg").show(),$("#saveRFID").show(),$(".addLoader").hide(),$("#rfidAdded").hide(),$("#rfidFail").hide(),$("#rfidModal").modal("show")})}createRFIDList(b){console.log(b);var c=Object.keys(b);let d=[];for(let e in b)d.push(b[e]);for(var a=0;a<c.length;a++)this.createRFID(a+1,d[a],c[a])}}$(function(){let a=(a="default",c="",b="")=>{$("#rfidLabel").text(c),$("#msg").hide(),$("#saveRFID").hide(),"addOK"===a||"savedOK"===a?($(".addLoader").hide(),$("#rfidFail").hide(),$("#rfidAdded").text(b),$('<br><br><i class="fas fa-check-circle fa-3x" style="color:green;"></i>').appendTo("#rfidAdded"),$("#rfidAdded").show()):"addWaiting"===a?($(".addLoader").show(),$("#rfidFail").hide(),$("#rfidAdded").hide()):("savedNOK"===a||"addNOK"===a)&&($(".addLoader").hide(),$("#rfidAdded").hide(),$("#rfidFail").text(b),$('<br><br><i class="fas fa-exclamation-triangle fa-3x" style="color:red;"></i>'+b).appendTo("#rfidFail"),$("#rfidFail").show()),$("#rfidModal").modal("show")};$(document).on("click","#refreshRfid",function(){for(let a=1;a<=20;a++)if($("#rfid"+a))$("#rfid"+a).remove();else break;$.ajax({url:"/updateRFID"}).done(function(a){new CreateRfidList(a)})}),$(document).on("click","#addRfid",function(){let b=0;$.ajax({type:"POST",url:"/updateRFID",async:!0,data:JSON.stringify({addRfid:0}),success:function(b){1==b.addRfid&&a("addWaiting","Approach RFID card to the RFID reader.")},error:function(b){a("addNOK","Approach RFID card to the RFID reader.","Check rfid or network conneciton.")}}),timer=setInterval(function(){++b>2&&(a("addOK","Approach RFID card to the RFID reader.","Card added successfully!"),clearTimeout(timer))},2e3)}),$(document).on("click","#saveRfid",function(){$.ajax({type:"POST",url:"/updateRFID",async:!0,data:JSON.stringify({saveRfid:1}),success:function(b){1==b.saveRfid?a("savedOK","Save value to memory.","Value was saved successfully!"):a("savedNOK","Save value to memory.","Check rfid or network conneciton.")},error:function(b){a("savedNOK","Save value to memory.","Check rfid or network conneciton.")}})})})